/* ----------------------------------------------------*/
/* ИМЯ: Pogosian Samvel, ID пользователя: 23К0180      */
/* ДАТА: 06/10/2025                                    */
/* НАЗНАЧЕНИЕ ПРОГРАММЫ:                               */
/* Программа считывает строку любой длины,            */
/* удаляет из неё все строчные буквы и возвращает     */
/* количество удалённых символов.                     */
/* ИСПОЛЬЗУЕМЫЕ ФУНКЦИИ:                               */
/* main() – ввод строки, вызов функции удаления       */
/*          строчных букв, вывод результата.         */
/* remove_lowercase() – удаляет строчные буквы и     */
/*          возвращает их количество.                */
/* ФАЙЛ: main2.c                                      */
/* ----------------------------------------------------*/

#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>

/* ----------------------------------------------------*/
/* ФУНКЦИЯ: remove_lowercase                           */
/* ПАРАМЕТРЫ:                                        */
/*  str – указатель на строку, из которой удаляются  */
/*        строчные буквы                               */
/* ВОЗВРАЩАЕМОЕ ЗНАЧЕНИЕ:                            */
/*  Количество удалённых строчных букв               */
/* ЗАДАЧА:                                           */
/*  Проходит по строке, сдвигает непрописные символы */
/*  влево, считает количество удалённых строчных     */
/*  букв и корректно завершает строку '\0'.         */
/* ----------------------------------------------------*/

int remove_lowercase(char *str) {
    int count = 0;
    int i = 0;
    int j = 0;
    while (str[i] != '\0') {
        if (islower((unsigned char) str[i])) {
            count++;
        } else {
            str[j++] = str[i];
        }
        i++;
    }
    str[j] = '\0';
    return count;
}

/* ----------------------------------------------------*/
/* ФУНКЦИЯ: main                                     */
/* ПАРАМЕТРЫ: нет                                    */
/* ЗАДАЧА:                                           */
/*  1. Считывает строку любой длины с помощью getline*/
/*  2. Удаляет символ новой строки, если она есть    */
/*  3. Выводит исходную строку                        */
/*  4. Вызывает remove_lowercase() для обработки     */
/*  5. Выводит количество удалённых строчных букв    */
/*  6. Выводит результат                              */
/*  7. Освобождает динамически выделенную память     */
/* ----------------------------------------------------*/

int main() {
    char *string = NULL;

    size_t size = 0;

    printf("Input the string with upper and lower case letters:\n");
    
    ssize_t len = getline(&string, &size, stdin); // Read the string with any length
    
    if (len == -1) {
        perror("getline");
        return 1;
    }

    if (string[len - 1] == '\n') {
        string[len - 1] = '\0'; 
    }

    printf("Initial string is %s\n", string);

    int removed_letters = remove_lowercase(string);
    printf("Removed lowercase letters count = %d\n", removed_letters);
    printf("Result string is %s\n", string);
    free(string);
    return 0;
}
